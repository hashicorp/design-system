{"version":3,"file":"dom-management.js","sources":["../../../src/modifiers/hds-advanced-table-cell/dom-management.ts"],"sourcesContent":["/**\n * Copyright (c) HashiCorp, Inc.\n * SPDX-License-Identifier: MPL-2.0\n */\n\nimport { tabbable } from 'tabbable';\n\nimport type { HdsAdvancedTableTdSignature } from '../../components/hds/advanced-table/td.ts';\nimport type { HdsAdvancedTableThSignature } from '../../components/hds/advanced-table/th.ts';\n\nexport const onFocusTrapDeactivate = (cell: HTMLDivElement) => {\n  const cellTabbableChildren = tabbable(cell);\n\n  for (const child of cellTabbableChildren) {\n    child.setAttribute('tabindex', '-1');\n  }\n\n  cell.setAttribute('tabindex', '0');\n};\n\nexport const updateTabbableChildren = (\n  cell: HTMLDivElement,\n  isFocusTrapActive?: boolean\n): void => {\n  const cellTabbableChildren = tabbable(cell);\n\n  for (const child of cellTabbableChildren) {\n    if (child instanceof HTMLElement) {\n      if (!isFocusTrapActive) {\n        child.setAttribute('tabindex', '-1');\n      }\n      child.setAttribute('data-advanced-table-child-focusable', '');\n    }\n  }\n};\n\nexport const didInsertGridCell = (\n  cell:\n    | HdsAdvancedTableThSignature['Element']\n    | HdsAdvancedTableTdSignature['Element']\n): void => {\n  updateTabbableChildren(cell);\n\n  const currentRow = cell.parentElement;\n\n  if (\n    currentRow?.parentElement?.classList.contains('hds-advanced-table__thead')\n  ) {\n    const thead = currentRow.parentElement;\n    if (\n      thead.children.item(0) === currentRow &&\n      currentRow.children.item(0) === cell\n    ) {\n      cell.setAttribute('tabindex', '0');\n    } else {\n      cell.setAttribute('tabindex', '-1');\n    }\n  } else if (\n    currentRow?.parentElement?.classList.contains('hds-advanced-table__tbody')\n  ) {\n    const grid = currentRow.parentElement?.closest('[role=\"grid\"]');\n    const thead = grid?.querySelector(\n      '[role=\"rowgroup\"].hds-advanced-table__thead'\n    );\n    const tbody = grid?.querySelector(\n      '[role=\"rowgroup\"].hds-advanced-table__tbody'\n    );\n\n    if (thead === null) {\n      if (\n        tbody?.children.item(0) === currentRow &&\n        currentRow.children.item(0) === cell\n      ) {\n        cell.setAttribute('tabindex', '0');\n      }\n    } else {\n      cell.setAttribute('tabindex', '-1');\n    }\n  }\n};\n"],"names":["onFocusTrapDeactivate","cell","cellTabbableChildren","tabbable","child","setAttribute","updateTabbableChildren","isFocusTrapActive","HTMLElement","didInsertGridCell","currentRow","parentElement","classList","contains","thead","children","item","grid","closest","querySelector","tbody"],"mappings":";;AAAA;AACA;AACA;AACA;;AAOaA,MAAAA,qBAAqB,GAAIC,IAAoB,IAAK;AAC7D,EAAA,MAAMC,oBAAoB,GAAGC,QAAQ,CAACF,IAAI,CAAC;AAE3C,EAAA,KAAK,MAAMG,KAAK,IAAIF,oBAAoB,EAAE;AACxCE,IAAAA,KAAK,CAACC,YAAY,CAAC,UAAU,EAAE,IAAI,CAAC;AACtC;AAEAJ,EAAAA,IAAI,CAACI,YAAY,CAAC,UAAU,EAAE,GAAG,CAAC;AACpC;MAEaC,sBAAsB,GAAGA,CACpCL,IAAoB,EACpBM,iBAA2B,KAClB;AACT,EAAA,MAAML,oBAAoB,GAAGC,QAAQ,CAACF,IAAI,CAAC;AAE3C,EAAA,KAAK,MAAMG,KAAK,IAAIF,oBAAoB,EAAE;IACxC,IAAIE,KAAK,YAAYI,WAAW,EAAE;MAChC,IAAI,CAACD,iBAAiB,EAAE;AACtBH,QAAAA,KAAK,CAACC,YAAY,CAAC,UAAU,EAAE,IAAI,CAAC;AACtC;AACAD,MAAAA,KAAK,CAACC,YAAY,CAAC,qCAAqC,EAAE,EAAE,CAAC;AAC/D;AACF;AACF;AAEaI,MAAAA,iBAAiB,GAC5BR,IAE0C,IACjC;EACTK,sBAAsB,CAACL,IAAI,CAAC;AAE5B,EAAA,MAAMS,UAAU,GAAGT,IAAI,CAACU,aAAa;EAErC,IACED,UAAU,EAAEC,aAAa,EAAEC,SAAS,CAACC,QAAQ,CAAC,2BAA2B,CAAC,EAC1E;AACA,IAAA,MAAMC,KAAK,GAAGJ,UAAU,CAACC,aAAa;IACtC,IACEG,KAAK,CAACC,QAAQ,CAACC,IAAI,CAAC,CAAC,CAAC,KAAKN,UAAU,IACrCA,UAAU,CAACK,QAAQ,CAACC,IAAI,CAAC,CAAC,CAAC,KAAKf,IAAI,EACpC;AACAA,MAAAA,IAAI,CAACI,YAAY,CAAC,UAAU,EAAE,GAAG,CAAC;AACpC,KAAC,MAAM;AACLJ,MAAAA,IAAI,CAACI,YAAY,CAAC,UAAU,EAAE,IAAI,CAAC;AACrC;AACF,GAAC,MAAM,IACLK,UAAU,EAAEC,aAAa,EAAEC,SAAS,CAACC,QAAQ,CAAC,2BAA2B,CAAC,EAC1E;IACA,MAAMI,IAAI,GAAGP,UAAU,CAACC,aAAa,EAAEO,OAAO,CAAC,eAAe,CAAC;AAC/D,IAAA,MAAMJ,KAAK,GAAGG,IAAI,EAAEE,aAAa,CAC/B,6CACF,CAAC;AACD,IAAA,MAAMC,KAAK,GAAGH,IAAI,EAAEE,aAAa,CAC/B,6CACF,CAAC;IAED,IAAIL,KAAK,KAAK,IAAI,EAAE;MAClB,IACEM,KAAK,EAAEL,QAAQ,CAACC,IAAI,CAAC,CAAC,CAAC,KAAKN,UAAU,IACtCA,UAAU,CAACK,QAAQ,CAACC,IAAI,CAAC,CAAC,CAAC,KAAKf,IAAI,EACpC;AACAA,QAAAA,IAAI,CAACI,YAAY,CAAC,UAAU,EAAE,GAAG,CAAC;AACpC;AACF,KAAC,MAAM;AACLJ,MAAAA,IAAI,CAACI,YAAY,CAAC,UAAU,EAAE,IAAI,CAAC;AACrC;AACF;AACF;;;;"}