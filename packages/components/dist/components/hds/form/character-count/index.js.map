{"version":3,"file":"index.js","sources":["../../../../../src/components/hds/form/character-count/index.hbs","../../../../../src/components/hds/form/character-count/index.ts"],"sourcesContent":["import { precompileTemplate } from \"@ember/template-compilation\";\nexport default precompileTemplate(\"{{!\\n  Copyright (c) HashiCorp, Inc.\\n  SPDX-License-Identifier: MPL-2.0\\n}}\\n<Hds::Text::Body\\n  @tag=\\\"div\\\"\\n  @size=\\\"100\\\"\\n  class={{this.classNames}}\\n  id={{this.id}}\\n  {{did-insert this.onInsert}}\\n  ...attributes\\n  aria-live=\\\"polite\\\"\\n>\\n  {{#if (has-block)}}\\n    {{yield\\n      (hash\\n        minLength=this.minLength\\n        maxLength=this.maxLength\\n        currentLength=this.currentLength\\n        remaining=this.remaining\\n        shortfall=this.shortfall\\n      )\\n    }}\\n  {{else}}\\n    {{this.message}}\\n  {{/if}}\\n</Hds::Text::Body>\")","/**\n * Copyright (c) HashiCorp, Inc.\n * SPDX-License-Identifier: MPL-2.0\n */\n\nimport Component from '@glimmer/component';\nimport type { HdsTextBodySignature } from '../../text/body';\n\nconst ID_PREFIX = 'character-count-';\nconst NOOP = (): void => {};\n\ninterface HdsFormCharacterCountSignature {\n  Args: {\n    contextualClass?: string;\n    controlId?: string;\n    maxLength?: number | string;\n    minLength?: number | string;\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    onInsert?: (element: HTMLElement, ...args: any[]) => void;\n    value?: string;\n  };\n  Blocks: {\n    default?: [\n      {\n        minLength?: number;\n        maxLength?: number;\n        currentLength?: number;\n        remaining?: number;\n        shortfall?: number;\n      },\n    ];\n  };\n  Element: HdsTextBodySignature['Element'];\n}\n\nexport default class HdsFormCharacterCountComponent extends Component<HdsFormCharacterCountSignature> {\n  // The current number of characters in @value\n  get currentLength(): number {\n    const { value } = this.args;\n    return value ? value.length : 0;\n  }\n\n  // Inflector utility function to determine plural or singular for 'character' noun\n  private _pluralize(\n    count?: number,\n    prefix = '',\n    noun = 'character',\n    suffix = 's'\n  ): string {\n    return `${count}${prefix ? ' ' + prefix : ''} ${noun}${\n      count !== 1 ? suffix : ''\n    }`;\n  }\n\n  /**\n   * @param maxLength\n   * @type {number}\n   * @default null\n   * @description The maximum number of characters allowed.\n   */\n  get maxLength(): number | undefined {\n    const { maxLength } = this.args;\n    if (maxLength) {\n      return typeof maxLength === 'number' ? maxLength : parseInt(maxLength);\n    }\n  }\n\n  /**\n   * @param minLength\n   * @type {number}\n   * @default null\n   * @description The minimum number of characters allowed.\n   */\n  get minLength(): number | undefined {\n    const { minLength } = this.args;\n    if (minLength) {\n      return typeof minLength === 'number' ? minLength : parseInt(minLength);\n    }\n  }\n\n  /**\n   * @param remaining\n   * @type {number}\n   * @default null\n   * @description The remaining number of characters.\n   */\n  get remaining(): number | undefined {\n    return this.maxLength ? this.maxLength - this.currentLength : undefined;\n  }\n\n  /**\n   * @param shortfall\n   * @type {number}\n   * @default null\n   * @description The number of characters the content is falling short of.\n   */\n  get shortfall(): number | undefined {\n    return this.minLength ? this.minLength - this.currentLength : undefined;\n  }\n\n  /**\n   * @param message\n   * @type {string}\n   * @default null\n   * @description The character count message presented to users\n   */\n  get message(): string {\n    let messageText = '';\n    if (this.minLength && this.currentLength === 0) {\n      messageText = `${this._pluralize(this.minLength)} required`;\n    } else if (this.minLength && this.currentLength < this.minLength) {\n      messageText = `${this._pluralize(this.shortfall, 'more')} required`;\n    } else if (this.maxLength && this.currentLength === 0) {\n      messageText = `${this._pluralize(this.maxLength)} allowed`;\n    } else if (this.maxLength && this.currentLength <= this.maxLength) {\n      messageText = `${this._pluralize(this.remaining)} remaining`;\n    } else if (\n      this.maxLength &&\n      this.remaining &&\n      this.currentLength > this.maxLength\n    ) {\n      messageText = `Exceeded by ${this._pluralize(-this.remaining)}`;\n    } else {\n      messageText = `${this._pluralize(this.currentLength)} entered`;\n    }\n    return messageText;\n  }\n\n  /**\n   * Determines the unique ID to assign to the element\n   * @method id\n   * @return {(string|null)} The \"id\" attribute to apply to the element or null, if no controlId is provided\n   */\n  get id(): string | null {\n    const { controlId } = this.args;\n    if (controlId) {\n      return `${ID_PREFIX}${controlId}`;\n    }\n    return null;\n  }\n\n  /**\n   * @param onInsert\n   * @type {function}\n   * @default () => {}\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  get onInsert(): (element: HTMLElement, ...args: any[]) => void {\n    const { onInsert } = this.args;\n    // notice: this is a guard used to prevent triggering an error when the component is used as standalone element\n    if (typeof onInsert === 'function') {\n      return onInsert;\n    } else {\n      return NOOP;\n    }\n  }\n  /**\n   * Get the class names to apply to the component.\n   * @method classNames\n   * @return {string} The \"class\" attribute to apply to the component.\n   */\n  get classNames(): string {\n    const classes = ['hds-form-character-count'];\n\n    // add a class based on the @contextualClass argument\n    // notice: this will *not* be documented for public use\n    // the reason for this is that the contextual component declarations don't pass attributes to the component\n    if (this.args.contextualClass) {\n      classes.push(this.args.contextualClass);\n    }\n\n    return classes.join(' ');\n  }\n}\n"],"names":["ID_PREFIX","NOOP","HdsFormCharacterCountComponent","Component","currentLength","value","args","length","_pluralize","count","prefix","noun","suffix","maxLength","parseInt","minLength","remaining","undefined","shortfall","message","messageText","id","controlId","onInsert","classNames","classes","contextualClass","push","join","setComponentTemplate","TEMPLATE"],"mappings":"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"}