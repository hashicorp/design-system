{"version":3,"file":"index.js","sources":["../../../../src/components/hds/tag/index.ts"],"sourcesContent":["/**\n * Copyright (c) HashiCorp, Inc.\n * SPDX-License-Identifier: MPL-2.0\n */\n\nimport Component from '@glimmer/component';\nimport { tracked } from '@glimmer/tracking';\nimport { TrackedWeakSet } from 'tracked-built-ins';\nimport { assert } from '@ember/debug';\nimport { modifier } from 'ember-modifier';\n\nimport { HdsTagColorValues } from './types.ts';\nimport type { HdsTagColors } from './types.ts';\nimport { HdsTagTooltipPlacementValues } from './types.ts';\nimport type { HdsTagTooltipPlacements } from './types.ts';\nimport type { HdsInteractiveSignature } from '../interactive/';\n\nexport const COLORS: HdsTagColors[] = Object.values(HdsTagColorValues);\nexport const DEFAULT_COLOR = HdsTagColorValues.Primary;\nexport const TOOLTIP_PLACEMENTS: HdsTagTooltipPlacements[] = Object.values(\n  HdsTagTooltipPlacementValues\n);\nexport const DEFAULT_TOOLTIP_PLACEMENT = HdsTagTooltipPlacementValues.Top;\n\nexport interface HdsTagSignature {\n  Args: HdsInteractiveSignature['Args'] & {\n    color?: HdsTagColors;\n    text: string;\n    ariaLabel?: string;\n    tooltipPlacement?: HdsTagTooltipPlacements;\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    onDismiss?: (event: MouseEvent, ...args: any[]) => void;\n  };\n  Element: HTMLSpanElement;\n}\n\nconst overflowed = new TrackedWeakSet<Element>();\n\nconst observer = new ResizeObserver((entries) => {\n  entries.forEach((entry) => {\n    const textContainer = entry.target.querySelector(\n      '.hds-tag__text-container'\n    );\n    if (\n      textContainer &&\n      textContainer.scrollHeight > textContainer.clientHeight\n    ) {\n      overflowed.add(entry.target);\n    } else {\n      overflowed.delete(entry.target);\n    }\n  });\n});\n\nexport default class HdsTag extends Component<HdsTagSignature> {\n  @tracked private _element?: HTMLElement;\n  private get _isTextOverflow(): boolean {\n    if (!this._element) {\n      return false;\n    }\n    return overflowed.has(this._element);\n  }\n\n  private _setUpObserver = modifier((element: HTMLElement) => {\n    this._element = element;\n    observer.observe(element);\n\n    return () => {\n      if (this._element) {\n        observer.unobserve(this._element);\n      }\n      delete this._element;\n    };\n  });\n\n  /**\n   * @param tooltioPlacement\n   * @type {string}\n   * @default top\n   * @description The placement property of the tooltip attached to the tag text.\n   */\n  get tooltipPlacement(): HdsTagTooltipPlacements {\n    const { tooltipPlacement = DEFAULT_TOOLTIP_PLACEMENT } = this.args;\n\n    assert(\n      '@tooltipPlacement for \"Hds::Tag\" must have a valid value',\n      tooltipPlacement == undefined ||\n        TOOLTIP_PLACEMENTS.includes(tooltipPlacement)\n    );\n\n    return tooltipPlacement;\n  }\n\n  /**\n   * @param onDismiss\n   * @type {function}\n   * @default () => {}\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  get onDismiss(): ((event: MouseEvent, ...args: any[]) => void) | false {\n    const { onDismiss } = this.args;\n\n    if (typeof onDismiss === 'function') {\n      return onDismiss;\n    } else {\n      return false;\n    }\n  }\n\n  /**\n   * @param text\n   * @type {string}\n   * @description The text of the tag. If no text value is defined, an error will be thrown.\n   */\n  get text(): string {\n    const { text } = this.args;\n\n    assert('@text for \"Hds::Tag\" must have a valid value', text !== undefined);\n\n    return text;\n  }\n\n  /**\n   * @param ariaLabel\n   * @type {string}\n   * @default 'Dismiss'\n   */\n  get ariaLabel(): string {\n    const tagAriaLabel = this.args.ariaLabel ?? 'Dismiss';\n    return tagAriaLabel + ' ' + this.args.text;\n  }\n\n  /**\n   * @param color\n   * @type {string}\n   * @default primary\n   * @description Determines the color of link to be used; acceptable values are `primary` and `secondary`\n   */\n  get color(): HdsTagColors | false {\n    if (this.args.href || this.args.route) {\n      const { color = DEFAULT_COLOR } = this.args;\n      assert(\n        `@color for \"Hds::Tag\" must be one of the following: ${COLORS.join(\n          ', '\n        )}; received: ${color}`,\n        COLORS.includes(color)\n      );\n      return color;\n    } else if (this.args.color) {\n      assert(\n        '@color can only be applied to \"Hds::Tag\" along with either @href or @route',\n        this.args.href || this.args.route\n      );\n    }\n    return false;\n  }\n\n  /**\n   * Get the class names to apply to the component.\n   * @method classNames\n   * @return {string} The \"class\" attribute to apply to the component.\n   */\n  get classNames(): string {\n    const classes = ['hds-tag'];\n\n    // add a class based on the @color argument\n    if (this.color) {\n      classes.push(`hds-tag--color-${this.color}`);\n    }\n\n    return classes.join(' ');\n  }\n}\n"],"names":["COLORS","Object","values","HdsTagColorValues","DEFAULT_COLOR","Primary","TOOLTIP_PLACEMENTS","HdsTagTooltipPlacementValues","DEFAULT_TOOLTIP_PLACEMENT","Top","overflowed","TrackedWeakSet","observer","ResizeObserver","entries","forEach","entry","textContainer","target","querySelector","scrollHeight","clientHeight","add","delete","HdsTag","Component","g","prototype","tracked","i","void 0","_isTextOverflow","_element","has","_setUpObserver","modifier","element","observe","unobserve","tooltipPlacement","args","assert","undefined","includes","onDismiss","text","ariaLabel","tagAriaLabel","color","href","route","join","classNames","classes","push","setComponentTemplate","TEMPLATE"],"mappings":"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"}