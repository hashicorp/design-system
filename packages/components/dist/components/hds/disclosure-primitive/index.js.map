{"version":3,"file":"index.js","sources":["../../../../src/components/hds/disclosure-primitive/index.ts"],"sourcesContent":["/**\n * Copyright (c) HashiCorp, Inc.\n * SPDX-License-Identifier: MPL-2.0\n */\n\nimport Component from '@glimmer/component';\nimport { tracked } from '@glimmer/tracking';\nimport { action } from '@ember/object';\nimport { schedule } from '@ember/runloop';\n\nexport interface HdsDisclosurePrimitiveSignature {\n  Args: {\n    isOpen?: boolean;\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    onClose?: (...args: any[]) => void;\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    onClickToggle?: (...args: any[]) => void;\n  };\n  Blocks: {\n    toggle: [\n      {\n        isOpen: boolean;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        onClickToggle: (...args: any[]) => void;\n      },\n    ];\n    content: [\n      {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        close: (...args: any[]) => void;\n      },\n    ];\n  };\n  Element: HTMLDivElement;\n}\n\nexport default class HdsDisclosurePrimitive extends Component<HdsDisclosurePrimitiveSignature> {\n  @tracked private _isOpen = false;\n  @tracked private _isControlled = this.args.isOpen !== undefined;\n\n  get isOpen(): boolean {\n    if (this._isControlled) {\n      // if the state is controlled from outside, the argument overrides the internal state\n      return this.args.isOpen ?? this._isOpen;\n    } else {\n      // if the state changes internally, the internal state overrides the argument\n      return this._isOpen;\n    }\n  }\n\n  set isOpen(value) {\n    this._isOpen = value || false;\n  }\n\n  @action\n  onClickToggle(): void {\n    this.isOpen = !this.isOpen;\n    this._isControlled = false;\n    // we call the \"onClickToggle\" callback if it exists and it's a function\n    if (\n      this.args.onClickToggle &&\n      typeof this.args.onClickToggle === 'function'\n    ) {\n      this.args.onClickToggle(this.isOpen);\n    }\n  }\n\n  @action\n  onStateChange(): void {\n    if (this.args.isOpen !== undefined) {\n      this.isOpen = this.args.isOpen;\n    }\n    this._isControlled = true;\n  }\n\n  @action\n  close(): void {\n    // we schedule this afterRender to avoid an error in tests caused by updating `isOpen` multiple times in the same computation\n    // eslint-disable-next-line ember/no-runloop\n    schedule('afterRender', (): void => {\n      this.isOpen = false;\n      // we call the \"onClose\" callback if it exists (and is a function)\n      if (this.args.onClose && typeof this.args.onClose === 'function') {\n        this.args.onClose();\n      }\n    });\n  }\n}\n"],"names":["HdsDisclosurePrimitive","Component","g","prototype","tracked","i","void 0","args","isOpen","undefined","_isControlled","_isOpen","value","onClickToggle","n","action","onStateChange","close","schedule","onClose","setComponentTemplate","TEMPLATE"],"mappings":";;;;;;;;;;AAAA;AACA;AACA;AACA;;AAiCe,MAAMA,sBAAsB,SAASC,SAAS,CAAkC;AAAA,EAAA;IAAAC,CAAA,CAAA,IAAA,CAAAC,SAAA,EAAA,SAAA,EAAA,CAC5FC,OAAO,CAAA,EAAA,YAAA;AAAA,MAAA,OAAmB,KAAK;AAAA,KAAA,CAAA;AAAA;AAAA,EAAA,QAAA,IAAAC,CAAA,CAAA,IAAA,EAAA,SAAA,CAAA,EAAAC,SAAA;AAAA,EAAA;IAAAJ,CAAA,CAAA,IAAA,CAAAC,SAAA,EAAA,eAAA,EAAA,CAC/BC,OAAO,CAAA,EAAA,YAAA;AAAA,MAAA,OAAyB,IAAI,CAACG,IAAI,CAACC,MAAM,KAAKC,SAAS;AAAA,KAAA,CAAA;AAAA;AAAA,EAAA,cAAA,IAAAJ,CAAA,CAAA,IAAA,EAAA,eAAA,CAAA,EAAAC,SAAA;EAE/D,IAAIE,MAAMA,GAAY;IACpB,IAAI,IAAI,CAACE,aAAa,EAAE;AACtB;MACA,OAAO,IAAI,CAACH,IAAI,CAACC,MAAM,IAAI,IAAI,CAACG,OAAO;AACzC,KAAC,MAAM;AACL;MACA,OAAO,IAAI,CAACA,OAAO;AACrB;AACF;EAEA,IAAIH,MAAMA,CAACI,KAAK,EAAE;AAChB,IAAA,IAAI,CAACD,OAAO,GAAGC,KAAK,IAAI,KAAK;AAC/B;AAGAC,EAAAA,aAAaA,GAAS;AACpB,IAAA,IAAI,CAACL,MAAM,GAAG,CAAC,IAAI,CAACA,MAAM;IAC1B,IAAI,CAACE,aAAa,GAAG,KAAK;AAC1B;AACA,IAAA,IACE,IAAI,CAACH,IAAI,CAACM,aAAa,IACvB,OAAO,IAAI,CAACN,IAAI,CAACM,aAAa,KAAK,UAAU,EAC7C;MACA,IAAI,CAACN,IAAI,CAACM,aAAa,CAAC,IAAI,CAACL,MAAM,CAAC;AACtC;AACF;AAAC,EAAA;IAAAM,CAAA,CAAA,IAAA,CAAAX,SAAA,EAAA,eAAA,EAAA,CAXAY,MAAM,CAAA,CAAA;AAAA;AAcPC,EAAAA,aAAaA,GAAS;AACpB,IAAA,IAAI,IAAI,CAACT,IAAI,CAACC,MAAM,KAAKC,SAAS,EAAE;AAClC,MAAA,IAAI,CAACD,MAAM,GAAG,IAAI,CAACD,IAAI,CAACC,MAAM;AAChC;IACA,IAAI,CAACE,aAAa,GAAG,IAAI;AAC3B;AAAC,EAAA;IAAAI,CAAA,CAAA,IAAA,CAAAX,SAAA,EAAA,eAAA,EAAA,CANAY,MAAM,CAAA,CAAA;AAAA;AASPE,EAAAA,KAAKA,GAAS;AACZ;AACA;IACAC,QAAQ,CAAC,aAAa,EAAE,MAAY;MAClC,IAAI,CAACV,MAAM,GAAG,KAAK;AACnB;AACA,MAAA,IAAI,IAAI,CAACD,IAAI,CAACY,OAAO,IAAI,OAAO,IAAI,CAACZ,IAAI,CAACY,OAAO,KAAK,UAAU,EAAE;AAChE,QAAA,IAAI,CAACZ,IAAI,CAACY,OAAO,EAAE;AACrB;AACF,KAAC,CAAC;AACJ;AAAC,EAAA;IAAAL,CAAA,CAAA,IAAA,CAAAX,SAAA,EAAA,OAAA,EAAA,CAXAY,MAAM,CAAA,CAAA;AAAA;AAYT;AAACK,oBAAA,CAAAC,QAAA,EAnDoBrB,sBAAsB,CAAA;;;;"}