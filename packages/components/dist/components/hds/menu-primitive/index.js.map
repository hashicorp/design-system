{"version":3,"file":"index.js","sources":["../../../../src/components/hds/menu-primitive/index.hbs","../../../../src/components/hds/menu-primitive/index.ts"],"sourcesContent":["import { precompileTemplate } from \"@ember/template-compilation\";\nexport default precompileTemplate(\"{{!\\n  Copyright (c) HashiCorp, Inc.\\n  SPDX-License-Identifier: MPL-2.0\\n}}\\n{{!\\n  THIS COMPONENT IS NOW DEPRECATED\\n}}\\n{{! template-lint-disable no-invalid-interactive }}\\n<div\\n  class=\\\"hds-menu-primitive\\\"\\n  ...attributes\\n  {{did-insert this.didInsert}}\\n  {{on \\\"focusout\\\" this.onFocusOut}}\\n  {{on \\\"keyup\\\" this.onKeyUp}}\\n>\\n  <div class=\\\"hds-menu-primitive__toggle\\\" tabindex=\\\"-1\\\">\\n    {{yield (hash onClickToggle=this.onClickToggle isOpen=this.isOpen) to=\\\"toggle\\\"}}\\n  </div>\\n  {{#if this.isOpen}}\\n    <div class=\\\"hds-menu-primitive__content\\\" tabindex=\\\"-1\\\">\\n      {{yield (hash close=this.close) to=\\\"content\\\"}}\\n    </div>\\n  {{/if}}\\n</div>\\n{{! template-lint-enable no-invalid-interactive }}\")","/**\n * Copyright (c) HashiCorp, Inc.\n * SPDX-License-Identifier: MPL-2.0\n */\n\nimport Component from '@glimmer/component';\nimport { deprecate } from '@ember/debug';\nimport { tracked } from '@glimmer/tracking';\nimport { action } from '@ember/object';\nimport { schedule } from '@ember/runloop';\n\nexport interface MenuPrimitiveSignature {\n  Args: {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    onClose?: (...args: any[]) => void;\n  };\n  Blocks: {\n    toggle?: [\n      {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        onClickToggle: (event: MouseEvent, ...args: any[]) => void;\n        isOpen?: boolean;\n      },\n    ];\n    content?: [\n      {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        close: (...args: any[]) => void;\n      },\n    ];\n  };\n  Element: HTMLDivElement;\n}\n\nexport default class MenuPrimitive extends Component<MenuPrimitiveSignature> {\n  @tracked isOpen: boolean | undefined; // notice: if in the future we need to add a \"@isOpen\" prop to control the status from outside (eg to have the MenuPrimitive opened on render) just add  \"this.args.isOpen\" here to initalize the variable\n  @tracked toggleRef: HTMLElement | undefined;\n  @tracked element!: HTMLElement;\n\n  constructor(owner: unknown, args: MenuPrimitiveSignature['Args']) {\n    super(owner, args);\n\n    deprecate(\n      'The `Hds::MenuPrimitive` component is now deprecated and will be removed in the next major version of `@hashicorp/design-system-components`.',\n      false,\n      {\n        id: 'hds.components.menu-primitive',\n        until: '5.0.0',\n        url: 'https://helios.hashicorp.design/components/menu-primitive?tab=version%20history#460',\n        for: '@hashicorp/design-system-components',\n        since: {\n          enabled: '4.10.0',\n        },\n      }\n    );\n  }\n\n  @action\n  didInsert(element: HTMLElement): void {\n    this.element = element;\n  }\n\n  @action\n  onClickToggle(event: MouseEvent): void {\n    // we store a reference to the DOM node that has the \"onClickToggle\" event associated with it\n    if (!this.toggleRef) {\n      this.toggleRef = event.currentTarget as HTMLElement;\n    }\n    this.isOpen = !this.isOpen;\n    // we explicitly apply a focus state to the toggle element to overcome a bug in WebKit (see https://github.com/hashicorp/design-system/commit/40cd7f6b3cb15c45f9a1235fafd0fb3ed58e6e62)\n    this.toggleRef?.focus();\n  }\n\n  @action\n  onFocusOut(event: FocusEvent): void {\n    // due to inconsistent implementation of relatedTarget across browsers we use the activeElement as a fallback\n    // if the related target is not part of the disclosed content we close the disclosed container\n    if (\n      !this.element.contains(\n        (event.relatedTarget as Node) || (document.activeElement as Node)\n      )\n    ) {\n      this.close();\n    }\n  }\n\n  @action\n  onKeyUp(event: KeyboardEvent): void {\n    if (event.key === 'Escape') {\n      this.close();\n      this.toggleRef?.focus();\n    }\n  }\n\n  @action\n  close(): void {\n    // we schedule this afterRender to avoid an error in tests caused by updating `isOpen` multiple times in the same computation\n    // eslint-disable-next-line ember/no-runloop\n    schedule('afterRender', (): void => {\n      this.isOpen = false;\n      // we call the \"onClose\" callback if it exists (and is a function)\n      if (this.args.onClose && typeof this.args.onClose === 'function') {\n        this.args.onClose();\n      }\n    });\n  }\n}\n"],"names":["MenuPrimitive","_class","Component","constructor","owner","args","_initializerDefineProperty","_descriptor","_descriptor2","_descriptor3","deprecate","id","until","url","for","since","enabled","didInsert","element","onClickToggle","event","toggleRef","currentTarget","isOpen","focus","onFocusOut","contains","relatedTarget","document","activeElement","close","onKeyUp","key","schedule","onClose","_applyDecoratedDescriptor","prototype","tracked","configurable","enumerable","writable","initializer","action","Object","getOwnPropertyDescriptor","setComponentTemplate","TEMPLATE"],"mappings":"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"}