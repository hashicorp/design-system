{"version":3,"file":"th-selectable.js","sources":["../../../../src/components/hds/advanced-table/th-selectable.hbs","../../../../src/components/hds/advanced-table/th-selectable.ts"],"sourcesContent":["import { precompileTemplate } from \"@ember/template-compilation\";\nexport default precompileTemplate(\"{{!\\n  Copyright (c) HashiCorp, Inc.\\n  SPDX-License-Identifier: MPL-2.0\\n}}\\n\\n<Hds::AdvancedTable::Th\\n  class=\\\"hds-advanced-table__th--is-selectable\\\"\\n  aria-sort={{if this.isSortable this.ariaSort}}\\n  @scope={{@selectionScope}}\\n  ...attributes\\n>\\n  <div class=\\\"hds-advanced-table__th-content\\\">\\n    <Hds::Form::Checkbox::Base\\n      id={{this.checkboxId}}\\n      class=\\\"hds-advanced-table__checkbox\\\"\\n      checked={{@isSelected}}\\n      aria-label={{this.ariaLabel}}\\n      {{did-insert this.didInsertCheckbox}}\\n      {{will-destroy this.willDestroyNode}}\\n      {{on \\\"change\\\" this.onSelectionChange}}\\n    />\\n    {{#if this.isSortable}}\\n      <span id={{this.labelId}} class=\\\"sr-only\\\">selection state</span>\\n      <Hds::AdvancedTable::ThButtonSort\\n        @sortOrder={{@sortBySelectedOrder}}\\n        @onClick={{@onClickSortBySelected}}\\n        @labelId={{this.labelId}}\\n      />\\n    {{/if}}\\n  </div>\\n</Hds::AdvancedTable::Th>\")","/**\n * Copyright (c) HashiCorp, Inc.\n * SPDX-License-Identifier: MPL-2.0\n */\n\nimport Component from '@glimmer/component';\nimport { action } from '@ember/object';\nimport { guidFor } from '@ember/object/internals';\nimport { tracked } from '@glimmer/tracking';\nimport {\n  HdsAdvancedTableThSortOrderValues,\n  HdsAdvancedTableThSortOrderLabelValues,\n} from './types.ts';\nimport type { HdsFormCheckboxBaseSignature } from '../form/checkbox/base';\nimport type {\n  HdsAdvancedTableScope,\n  HdsAdvancedTableThSortOrder,\n  HdsAdvancedTableThSortOrderLabels,\n} from './types';\nimport type { HdsAdvancedTableThSignature } from './th';\n\nexport interface HdsAdvancedTableThSelectableSignature {\n  Args: {\n    didInsertCheckbox?: (\n      checkbox: HdsFormCheckboxBaseSignature['Element'],\n      selectionKey?: string\n    ) => void;\n    isSelected?: boolean;\n    onClickSortBySelected?: () => void;\n    onSelectionChange?: (\n      target: HdsFormCheckboxBaseSignature['Element'],\n      selectionKey: string | undefined\n    ) => void;\n    selectionAriaLabelSuffix?: string;\n    selectionKey?: string;\n    selectionScope?: HdsAdvancedTableScope;\n    sortBySelectedOrder?: HdsAdvancedTableThSortOrder;\n    willDestroy?: (selectionKey?: string) => void;\n  };\n  Element: HdsAdvancedTableThSignature['Element'];\n}\n\nexport default class HdsAdvancedTableThSelectable extends Component<HdsAdvancedTableThSelectableSignature> {\n  @tracked isSelected = this.args.isSelected ?? false;\n\n  guid = guidFor(this);\n\n  checkboxId = `checkbox-${this.guid}`;\n  labelId = `label-${this.guid}`;\n\n  get isSortable(): boolean {\n    return this.args.onClickSortBySelected !== undefined;\n  }\n\n  get ariaLabel(): string {\n    const { selectionAriaLabelSuffix } = this.args;\n    const prefix = this.isSelected ? 'Deselect' : 'Select';\n    if (selectionAriaLabelSuffix) {\n      return `${prefix} ${selectionAriaLabelSuffix}`;\n    } else {\n      return prefix;\n    }\n  }\n\n  get ariaSort(): HdsAdvancedTableThSortOrderLabels | undefined {\n    switch (this.args.sortBySelectedOrder) {\n      case HdsAdvancedTableThSortOrderValues.Asc:\n        return HdsAdvancedTableThSortOrderLabelValues.Asc;\n      case HdsAdvancedTableThSortOrderValues.Desc:\n        return HdsAdvancedTableThSortOrderLabelValues.Desc;\n      default:\n        // none is the default per the spec.\n        return HdsAdvancedTableThSortOrderLabelValues.None;\n    }\n  }\n\n  @action\n  didInsertCheckbox(checkbox: HdsFormCheckboxBaseSignature['Element']): void {\n    const { didInsertCheckbox } = this.args;\n    if (typeof didInsertCheckbox === 'function') {\n      didInsertCheckbox(checkbox, this.args.selectionKey);\n      // we need to use a custom event listener here because changing the `checked` value via JS\n      // (and this happens with the \"select all\") doesn't trigger the `change` event\n      // and consequently the `aria-label` won't be automatically updated (and so we have to force it)\n      checkbox.addEventListener(\n        'toggle',\n        this.updateAriaLabel.bind(this),\n        true\n      );\n    }\n  }\n\n  @action\n  willDestroyNode(checkbox: HdsFormCheckboxBaseSignature['Element']): void {\n    super.willDestroy();\n    const { willDestroy } = this.args;\n    if (typeof willDestroy === 'function') {\n      willDestroy(this.args.selectionKey);\n      if (checkbox) {\n        checkbox.removeEventListener(\n          'toggle',\n          this.updateAriaLabel.bind(this),\n          true\n        );\n      }\n    }\n  }\n\n  @action\n  onSelectionChange(event: Event): void {\n    // Assert event.target as HdsFormCheckboxBaseSignature['Element'] to access the 'checked' property\n    const target = event.target as HdsFormCheckboxBaseSignature['Element'];\n    this.isSelected = target.checked;\n    const { onSelectionChange } = this.args;\n    if (typeof onSelectionChange === 'function') {\n      onSelectionChange(target, this.args.selectionKey);\n    }\n  }\n\n  updateAriaLabel(event: Event): void {\n    // Assert event.target as HTMLInputElement to access the 'checked' property\n    const target = event.target as HdsFormCheckboxBaseSignature['Element'];\n    this.isSelected = target.checked;\n  }\n}\n"],"names":["HdsAdvancedTableThSelectable","_class","Component","constructor","args","_initializerDefineProperty","_descriptor","_defineProperty","guidFor","guid","isSortable","onClickSortBySelected","undefined","ariaLabel","selectionAriaLabelSuffix","prefix","isSelected","ariaSort","sortBySelectedOrder","HdsAdvancedTableThSortOrderValues","Asc","HdsAdvancedTableThSortOrderLabelValues","Desc","None","didInsertCheckbox","checkbox","selectionKey","addEventListener","updateAriaLabel","bind","willDestroyNode","willDestroy","removeEventListener","onSelectionChange","event","target","checked","_applyDecoratedDescriptor","prototype","tracked","configurable","enumerable","writable","initializer","action","Object","getOwnPropertyDescriptor","setComponentTemplate","TEMPLATE"],"mappings":"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"}