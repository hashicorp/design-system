{"version":3,"file":"index.js","sources":["../../../../src/components/hds/app-side-nav/index.hbs","../../../../src/components/hds/app-side-nav/index.ts"],"sourcesContent":["import { precompileTemplate } from \"@ember/template-compilation\";\nexport default precompileTemplate(\"{{!\\n  Copyright (c) HashiCorp, Inc.\\n  SPDX-License-Identifier: MPL-2.0\\n}}\\n{{! IMPORTANT: we need to add \\\"squishies\\\" here (~) because otherwise the whitespace added by Ember causes the empty element to still have visible padding - See https://handlebarsjs.com/guide/expressions.html#whitespace-control }}\\n<div\\n  class={{this.classNames}}\\n  ...attributes\\n  {{on \\\"transitionstart\\\" (fn this.setTransition \\\"start\\\")}}\\n  {{on \\\"transitionend\\\" (fn this.setTransition \\\"end\\\")}}\\n  {{! @glint-expect-error - https://github.com/josemarluedke/ember-focus-trap/issues/86 }}\\n  {{focus-trap isActive=this.shouldTrapFocus}}\\n  {{did-insert this.didInsert}}\\n>\\n  <h2 class=\\\"sr-only\\\" id=\\\"hds-app-side-nav-header\\\">Application local navigation</h2>\\n\\n  <div class=\\\"hds-app-side-nav__wrapper\\\">\\n    {{#if this.showToggleButton}}\\n      {{! template-lint-disable no-invalid-interactive}}\\n      <div class=\\\"hds-app-side-nav__overlay\\\" {{on \\\"click\\\" this.toggleMinimizedStatus}} />\\n      {{! template-lint-enable no-invalid-interactive}}\\n      <Hds::AppSideNav::ToggleButton\\n        aria-labelledby=\\\"hds-app-side-nav-header\\\"\\n        aria-expanded={{if this._isMinimized \\\"false\\\" \\\"true\\\"}}\\n        @icon={{if this._isMinimized \\\"chevrons-right\\\" \\\"chevrons-left\\\"}}\\n        {{on \\\"click\\\" this.toggleMinimizedStatus}}\\n      />\\n    {{/if}}\\n\\n    <div class=\\\"hds-app-side-nav__wrapper-body\\\">\\n      {{~yield~}}\\n    </div>\\n  </div>\\n</div>\")","/**\n * Copyright (c) HashiCorp, Inc.\n * SPDX-License-Identifier: MPL-2.0\n */\n\nimport Component from '@glimmer/component';\nimport { tracked } from '@glimmer/tracking';\nimport { action } from '@ember/object';\nimport { registerDestructor } from '@ember/destroyable';\nimport type Owner from '@ember/owner';\n\nexport interface HdsAppSideNavSignature {\n  Args: {\n    isResponsive?: boolean;\n    isCollapsible?: boolean;\n    isMinimized?: boolean;\n    onToggleMinimizedStatus?: (arg: boolean) => void;\n    onDesktopViewportChange?: (arg: boolean) => void;\n  };\n  Blocks: {\n    default?: [];\n  };\n  Element: HTMLDivElement;\n}\n\nexport default class HdsAppSideNav extends Component<HdsAppSideNavSignature> {\n  @tracked private _isMinimized;\n  @tracked private _isAnimating = false;\n  @tracked private _isDesktop = true;\n\n  private _body!: HTMLElement;\n  private _bodyInitialOverflowValue = '';\n  private _desktopMQ: MediaQueryList;\n  private _containersToHide!: NodeListOf<Element>;\n\n  private _desktopMQVal = getComputedStyle(\n    document.documentElement\n  ).getPropertyValue('--hds-app-desktop-breakpoint');\n\n  constructor(owner: Owner, args: HdsAppSideNavSignature['Args']) {\n    super(owner, args);\n    this._isMinimized = this.args.isMinimized ?? false; // sets the default state on 'desktop' viewports\n    this._desktopMQ = window.matchMedia(`(min-width:${this._desktopMQVal})`);\n    this.addEventListeners();\n    registerDestructor(this, (): void => {\n      this.removeEventListeners();\n    });\n  }\n\n  addEventListeners(): void {\n    document.addEventListener('keydown', this.escapePress, true);\n    this._desktopMQ.addEventListener(\n      'change',\n      this.updateDesktopVariable,\n      true\n    );\n    // if not instantiated as minimized via arguments\n    if (!this.args.isMinimized) {\n      // set initial state based on viewport using a \"synthetic\" event\n      const syntheticEvent = new MediaQueryListEvent('change', {\n        matches: this._desktopMQ.matches,\n        media: this._desktopMQ.media,\n      });\n      this.updateDesktopVariable(syntheticEvent);\n    }\n  }\n\n  removeEventListeners(): void {\n    document.removeEventListener('keydown', this.escapePress, true);\n    this._desktopMQ.removeEventListener(\n      'change',\n      this.updateDesktopVariable,\n      true\n    );\n  }\n\n  // controls if the component reacts to viewport changes\n  get isResponsive(): boolean {\n    return this.args.isResponsive ?? true;\n  }\n\n  // controls if users can collapse the appsidenav on 'desktop' viewports\n  get isCollapsible(): boolean {\n    return this.args.isCollapsible ?? false;\n  }\n\n  get shouldTrapFocus(): boolean {\n    return this.isResponsive && !this._isDesktop && !this._isMinimized;\n  }\n\n  get showToggleButton(): boolean {\n    return (this.isResponsive && !this._isDesktop) || this.isCollapsible;\n  }\n\n  get classNames(): string {\n    const classes = [`hds-app-side-nav`];\n\n    // add specific class names for the different possible states\n    if (this.isResponsive) {\n      classes.push('hds-app-side-nav--is-responsive');\n    }\n    if (!this._isDesktop && this.isResponsive) {\n      classes.push('hds-app-side-nav--is-mobile');\n    } else {\n      classes.push('hds-app-side-nav--is-desktop');\n    }\n    if (this._isMinimized && this.isResponsive) {\n      classes.push('hds-app-side-nav--is-minimized');\n    } else {\n      classes.push('hds-app-side-nav--is-not-minimized');\n    }\n    if (this._isAnimating) {\n      classes.push('hds-app-side-nav--is-animating');\n    }\n\n    return classes.join(' ');\n  }\n\n  synchronizeInert(): void {\n    this._containersToHide?.forEach((element): void => {\n      if (this._isMinimized) {\n        element.setAttribute('inert', '');\n      } else {\n        element.removeAttribute('inert');\n      }\n    });\n  }\n\n  lockBodyScroll(): void {\n    if (this._body) {\n      // Prevent page from scrolling when the dialog is open\n      this._body.style.setProperty('overflow', 'hidden');\n    }\n  }\n\n  unlockBodyScroll(): void {\n    // Reset page `overflow` property\n    if (this._body) {\n      this._body.style.removeProperty('overflow');\n      if (this._bodyInitialOverflowValue === '') {\n        if (this._body.style.length === 0) {\n          this._body.removeAttribute('style');\n        }\n      } else {\n        this._body.style.setProperty(\n          'overflow',\n          this._bodyInitialOverflowValue\n        );\n      }\n    }\n  }\n\n  @action\n  escapePress(event: KeyboardEvent): void {\n    if (event.key === 'Escape' && !this._isMinimized && !this._isDesktop) {\n      this._isMinimized = true;\n      this.synchronizeInert();\n    }\n  }\n\n  @action\n  toggleMinimizedStatus(): void {\n    this._isMinimized = !this._isMinimized;\n    this.synchronizeInert();\n\n    const { onToggleMinimizedStatus } = this.args;\n\n    if (typeof onToggleMinimizedStatus === 'function') {\n      onToggleMinimizedStatus(this._isMinimized);\n    }\n\n    if (this._isMinimized) {\n      this.unlockBodyScroll();\n    } else {\n      this.lockBodyScroll();\n    }\n  }\n\n  @action\n  didInsert(element: HTMLElement): void {\n    this._containersToHide = element.querySelectorAll(\n      '.hds-app-side-nav-hide-when-minimized'\n    );\n    this._body = document.body;\n    // Store the initial `overflow` value of `<body>` so we can reset to it\n    this._bodyInitialOverflowValue =\n      this._body.style.getPropertyValue('overflow');\n  }\n\n  @action\n  setTransition(phase: string, event: TransitionEvent): void {\n    // we only want to respond to `width` animation/transitions\n    if (event.propertyName !== 'width') {\n      return;\n    }\n    if (phase === 'start') {\n      this._isAnimating = true;\n    } else {\n      this._isAnimating = false;\n    }\n  }\n\n  @action\n  updateDesktopVariable(event: MediaQueryListEvent): void {\n    this._isDesktop = event.matches;\n\n    // automatically minimize on narrow viewports (when not in desktop mode)\n    this._isMinimized = !this._isDesktop;\n\n    this.synchronizeInert();\n\n    const { onDesktopViewportChange } = this.args;\n\n    if (typeof onDesktopViewportChange === 'function') {\n      onDesktopViewportChange(this._isDesktop);\n    }\n  }\n}\n"],"names":["HdsAppSideNav","_class","Component","constructor","owner","args","_initializerDefineProperty","_descriptor","_descriptor2","_descriptor3","_defineProperty","getComputedStyle","document","documentElement","getPropertyValue","_isMinimized","isMinimized","_desktopMQ","window","matchMedia","_desktopMQVal","addEventListeners","registerDestructor","removeEventListeners","addEventListener","escapePress","updateDesktopVariable","syntheticEvent","MediaQueryListEvent","matches","media","removeEventListener","isResponsive","isCollapsible","shouldTrapFocus","_isDesktop","showToggleButton","classNames","classes","push","_isAnimating","join","synchronizeInert","_containersToHide","forEach","element","setAttribute","removeAttribute","lockBodyScroll","_body","style","setProperty","unlockBodyScroll","removeProperty","_bodyInitialOverflowValue","length","event","key","toggleMinimizedStatus","onToggleMinimizedStatus","didInsert","querySelectorAll","body","setTransition","phase","propertyName","onDesktopViewportChange","_applyDecoratedDescriptor","prototype","tracked","configurable","enumerable","writable","initializer","action","Object","getOwnPropertyDescriptor","setComponentTemplate","TEMPLATE"],"mappings":"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"}