{"version":3,"file":"index.js","sources":["../../../../src/components/hds/side-nav/index.ts"],"sourcesContent":["/**\n * Copyright (c) HashiCorp, Inc.\n * SPDX-License-Identifier: MPL-2.0\n */\n\nimport Component from '@glimmer/component';\nimport { deprecate } from '@ember/debug';\nimport { tracked } from '@glimmer/tracking';\nimport { action } from '@ember/object';\nimport { registerDestructor } from '@ember/destroyable';\n\nimport type { HdsSideNavBaseSignature } from './base';\nimport type Owner from '@ember/owner';\n\nexport interface HdsSideNavSignature {\n  Args: {\n    isResponsive?: boolean;\n    isCollapsible?: boolean;\n    isMinimized?: boolean;\n    hasA11yRefocus?: boolean;\n    a11yRefocusSkipTo?: string;\n    a11yRefocusSkipText?: string;\n    a11yRefocusNavigationText?: string;\n    a11yRefocusRouteChangeValidator?: string;\n    a11yRefocusExcludeAllQueryParams?: boolean;\n    /**\n     * @deprecated The `@ariaLabel` argument for \"Hds::SideNav\" has been deprecated. It is replaced by aria-labelledby and aria-expanded on the toggle button\n     */\n    ariaLabel?: string | undefined;\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    onToggleMinimizedStatus?: (arg: boolean) => void;\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    onDesktopViewportChange?: (arg: boolean) => void;\n  };\n  Blocks: {\n    header?: [\n      {\n        Header?: HdsSideNavBaseSignature['Blocks']['header'];\n        isMinimized?: boolean;\n      },\n    ];\n    body?: [\n      {\n        Body?: HdsSideNavBaseSignature['Blocks']['body'];\n        isMinimized?: boolean;\n      },\n    ];\n    footer?: [\n      {\n        Footer?: HdsSideNavBaseSignature['Blocks']['footer'];\n        isMinimized?: boolean;\n      },\n    ];\n  };\n  Element: HdsSideNavBaseSignature['Element'];\n}\n\nexport default class HdsSideNav extends Component<HdsSideNavSignature> {\n  @tracked isAnimating = false;\n  @tracked isDesktop = true;\n  @tracked isMinimized = false;\n\n  desktopMQ: MediaQueryList;\n  containersToHide!: NodeListOf<Element>;\n  hasA11yRefocus = this.args.hasA11yRefocus ?? true;\n  a11yRefocusSkipTo = '#' + (this.args.a11yRefocusSkipTo ?? 'hds-main');\n\n  desktopMQVal = getComputedStyle(document.documentElement).getPropertyValue(\n    '--hds-app-desktop-breakpoint'\n  );\n\n  constructor(owner: Owner, args: HdsSideNavSignature['Args']) {\n    super(owner, args);\n    // sets the default minimized state on 'desktop' viewports\n    this.isMinimized = this.args.isMinimized ?? false;\n    this.desktopMQ = window.matchMedia(`(min-width:${this.desktopMQVal})`);\n    this.addEventListeners();\n    registerDestructor(this, (): void => {\n      this.removeEventListeners();\n    });\n\n    if (args.ariaLabel !== undefined) {\n      deprecate(\n        'The `@ariaLabel` argument for \"Hds::SideNav\" has been deprecated. It is replaced by aria-labelledby and aria-expanded on the toggle button',\n        false,\n        {\n          id: 'hds.sidenav',\n          until: '5.0.0',\n          url: 'https://helios.hashicorp.design/components/side-nav?tab=version%20history#4140',\n          for: '@hashicorp/design-system-components',\n          since: {\n            available: '4.14.0',\n            enabled: '5.0.0',\n          },\n        }\n      );\n    }\n  }\n\n  addEventListeners(): void {\n    document.addEventListener('keydown', this.escapePress, true);\n    this.desktopMQ.addEventListener('change', this.updateDesktopVariable, true);\n    // if not instantiated as minimized via arguments\n    if (!this.args.isMinimized) {\n      // set initial state based on viewport using a \"synthetic\" event\n      const syntheticEvent = new MediaQueryListEvent('change', {\n        matches: this.desktopMQ.matches,\n        media: this.desktopMQ.media,\n      });\n      this.updateDesktopVariable(syntheticEvent);\n    }\n  }\n\n  removeEventListeners(): void {\n    document.removeEventListener('keydown', this.escapePress, true);\n    this.desktopMQ.removeEventListener(\n      'change',\n      this.updateDesktopVariable,\n      true\n    );\n  }\n\n  // controls if the component reacts to viewport changes\n  get isResponsive(): boolean {\n    return this.args.isResponsive ?? true;\n  }\n\n  // controls if users can collapse the appsidenav on 'desktop' viewports\n  get isCollapsible(): boolean {\n    return this.args.isCollapsible ?? false;\n  }\n\n  get shouldTrapFocus(): boolean {\n    return this.isResponsive && !this.isDesktop && !this.isMinimized;\n  }\n\n  get showToggleButton(): boolean {\n    return (this.isResponsive && !this.isDesktop) || this.isCollapsible;\n  }\n\n  /**\n   * @deprecated The `@ariaLabel` argument for \"Hds::SideNav\" has been deprecated. It is replaced by aria-labelledby and aria-expanded on the toggle button\n   */\n  get ariaLabel(): string | undefined {\n    return this.args.ariaLabel;\n  }\n\n  get classNames(): string {\n    const classes = []; // `hds-side-nav` is already set by the \"Hds::SideNav::Base\" component\n\n    // add specific class names for the different possible states\n    if (this.isResponsive) {\n      classes.push('hds-side-nav--is-responsive');\n    }\n    if (!this.isDesktop && this.isResponsive) {\n      classes.push('hds-side-nav--is-mobile');\n    } else {\n      classes.push('hds-side-nav--is-desktop');\n    }\n    if (this.isMinimized && this.isResponsive) {\n      classes.push('hds-side-nav--is-minimized');\n    } else {\n      classes.push('hds-side-nav--is-not-minimized');\n    }\n    if (this.isAnimating) {\n      classes.push('hds-side-nav--is-animating');\n    }\n\n    return classes.join(' ');\n  }\n\n  synchronizeInert(): void {\n    this.containersToHide?.forEach((element): void => {\n      if (this.isMinimized) {\n        element.setAttribute('inert', '');\n      } else {\n        element.removeAttribute('inert');\n      }\n    });\n  }\n\n  @action\n  escapePress(event: KeyboardEvent): void {\n    if (event.key === 'Escape' && !this.isMinimized && !this.isDesktop) {\n      this.isMinimized = true;\n      this.synchronizeInert();\n    }\n  }\n\n  @action\n  toggleMinimizedStatus(): void {\n    this.isMinimized = !this.isMinimized;\n\n    this.synchronizeInert();\n\n    const { onToggleMinimizedStatus } = this.args;\n\n    if (typeof onToggleMinimizedStatus === 'function') {\n      onToggleMinimizedStatus(this.isMinimized);\n    }\n  }\n\n  @action\n  didInsert(element: HTMLElement): void {\n    this.containersToHide = element.querySelectorAll(\n      '.hds-side-nav-hide-when-minimized'\n    );\n  }\n\n  @action\n  setTransition(phase: string, event: TransitionEvent): void {\n    // we only want to respond to `width` animation/transitions\n    if (event.propertyName !== 'width') {\n      return;\n    }\n    if (phase === 'start') {\n      this.isAnimating = true;\n    } else {\n      this.isAnimating = false;\n    }\n  }\n\n  @action\n  updateDesktopVariable(event: MediaQueryListEvent): void {\n    this.isDesktop = event.matches;\n\n    // automatically minimize on narrow viewports (when not in desktop mode)\n    this.isMinimized = !this.isDesktop;\n\n    this.synchronizeInert();\n\n    const { onDesktopViewportChange } = this.args;\n\n    if (typeof onDesktopViewportChange === 'function') {\n      onDesktopViewportChange(this.isDesktop);\n    }\n  }\n}\n"],"names":["HdsSideNav","Component","g","prototype","tracked","i","void 0","desktopMQ","containersToHide","hasA11yRefocus","args","a11yRefocusSkipTo","desktopMQVal","getComputedStyle","document","documentElement","getPropertyValue","constructor","owner","isMinimized","window","matchMedia","addEventListeners","registerDestructor","removeEventListeners","ariaLabel","undefined","deprecate","id","until","url","for","since","available","enabled","addEventListener","escapePress","updateDesktopVariable","syntheticEvent","MediaQueryListEvent","matches","media","removeEventListener","isResponsive","isCollapsible","shouldTrapFocus","isDesktop","showToggleButton","classNames","classes","push","isAnimating","join","synchronizeInert","forEach","element","setAttribute","removeAttribute","event","key","n","action","toggleMinimizedStatus","onToggleMinimizedStatus","didInsert","querySelectorAll","setTransition","phase","propertyName","onDesktopViewportChange","setComponentTemplate","TEMPLATE"],"mappings":"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"}