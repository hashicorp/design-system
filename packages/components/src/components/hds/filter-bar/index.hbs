{{!
  Copyright (c) HashiCorp, Inc.
  SPDX-License-Identifier: MPL-2.0
}}
<div class="hds-filter-bar" ...attributes>
  <div class="hds-filter-bar__actions">
    {{yield
      (hash FiltersDropdown=(component "hds/filter-bar/filters-dropdown" onFilter=this.onFilter filters=@filters))
    }}
    {{#if @hasSearch}}
      <Hds::Form::TextInput::Base
        @type="search"
        @width="320px"
        @value={{this.searchValue}}
        class="hds-filter-bar__search"
        placeholder={{hds-t "hds.components.filter-bar.search.placeholder" default="Search"}}
        aria-label={{hds-t "hds.components.filter-bar.search.aria-label" default="Search filters"}}
        name="search"
        {{on "change" this.onSearch}}
      />
    {{/if}}
    <div class="hds-filter-bar__actions__right">
      {{yield (hash ActionsDropdown=(component "hds/dropdown"))}}
      {{#if this.hasActiveFilters}}
        <Hds::Button
          @text={{if
            this._isExpanded
            (hds-t "hds.components.filter-bar.expand-collapse-button.collapse" default="Collapse filters")
            (hds-t "hds.components.filter-bar.expand-collapse-button.expand" default="Expand filters")
          }}
          @color="secondary"
          @size="small"
          @icon={{if this._isExpanded "unfold-close" "unfold-open"}}
          @isIconOnly={{true}}
          {{on "click" this.toggleExpand}}
        />
      {{/if}}
    </div>
  </div>
  {{#if (and this.hasActiveFilters this._isExpanded)}}
    <div class="hds-filter-bar__filters">
      {{#each-in @filters as |key filter|}}
        {{#if filter.data}}
          {{#if (and (eq filter.type "single-select"))}}
            <Hds::Tag
              @text="{{this._filterKeyText key filter}}: {{this._filterText filter.data}}"
              @onDismiss={{fn this.onFilterDismiss key}}
            />
          {{else if (eq filter.type "range")}}
            <Hds::Tag
              @text="{{this._filterKeyText key filter}} {{this._rangeFilterText filter.data}}"
              @onDismiss={{fn this.onFilterDismiss key}}
            />
          {{else if (eq filter.type "search")}}
            <Hds::Tag
              @text="{{this._filterKeyText key filter}}: {{this._filterText filter.data}}"
              @onDismiss={{fn this.onFilterDismiss key}}
            />
          {{else if (eq filter.type "multi-select")}}
            {{#each (this._filterArrayData filter.data) as |item|}}
              <Hds::Tag
                @text="{{this._filterKeyText key filter}}: {{item.value}}"
                @onDismiss={{fn this.onFilterDismiss key item.value}}
              />
            {{/each}}
          {{/if}}
        {{/if}}
      {{/each-in}}
      <Hds::Button
        class="hds-filter-bar__clear-button"
        @text="Clear all filters"
        @color="tertiary"
        @icon="x"
        @size="small"
        {{on "click" this.clearFilters}}
      />
    </div>
  {{/if}}
</div>