{{!
  Copyright (c) HashiCorp, Inc.
  SPDX-License-Identifier: MPL-2.0
}}
<div class="hds-filter-bar" ...attributes>
  <Hds::Layout::Flex @align="end" @gap="8" class="hds-filter-bar__actions">
    <Hds::Button
      @text={{if
        this._isExpanded
        (hds-t "hds.components.filter-bar.expand-collapse-button.collapse" default="Collapse filters")
        (hds-t "hds.components.filter-bar.expand-collapse-button.expand" default="Expand filters")
      }}
      @color="secondary"
      @size="small"
      @icon={{if this._isExpanded "unfold-close" "unfold-open"}}
      @isIconOnly={{true}}
      {{on "click" this.toggleExpand}}
    />
    {{yield
      (hash
        Dropdown=(component
          "hds/filter-bar/dropdown" filters=@filters isLiveFilter=@isLiveFilter onFilter=this.onFilter
        )
      )
    }}
    {{#if @hasSearch}}
      <Hds::Form::TextInput::Base
        @type="search"
        @width="320px"
        @value={{this.searchValue}}
        class="hds-filter-bar__search"
        placeholder={{this.searchPlaceholder}}
        aria-label={{hds-t "hds.components.filter-bar.search.aria-label" default="Search filters"}}
        name="search"
        {{on "change" this.onSearch}}
      />
    {{/if}}
    <Hds::Layout::Flex @gap="8" @align="center" class="hds-filter-bar__actions__right">
      {{yield (hash ActionsGeneric=(component "hds/yield"))}}
      {{yield (hash ActionsDropdown=(component "hds/dropdown"))}}
    </Hds::Layout::Flex>
  </Hds::Layout::Flex>
  {{#if this._isExpanded}}
    <div class="hds-filter-bar__applied-filters-list">
      {{#if this.hasActiveFilters}}
        {{#each-in @filters as |key filter|}}
          {{#if filter.data}}
            {{#if (eq filter.type "single-select")}}
              <Hds::Tag
                @text="{{this._getFilterKeyText key filter}}: {{this._getFilterValueText filter}}"
                @onDismiss={{fn this._onFilterDismiss key}}
              />
            {{else if (eq filter.type "numerical")}}
              <Hds::Tag
                @text="{{this._getFilterKeyText key filter}} {{this._getNumericalFilterValueText filter}}"
                @onDismiss={{fn this._onFilterDismiss key}}
              />
            {{else if (or (eq filter.type "date") (eq filter.type "datetime") (eq filter.type "time"))}}
              <Hds::Tag
                @text="{{this._getFilterKeyText key filter}} {{this._getDateFilterValueText filter}}"
                @onDismiss={{fn this._onFilterDismiss key}}
              />
            {{else if (eq filter.type "search")}}
              <Hds::Tag
                @text="{{this._getFilterKeyText key filter}}: {{this._getFilterValueText filter}}"
                @onDismiss={{fn this._onFilterDismiss key}}
              />
            {{else if (eq filter.type "generic")}}
              <Hds::Tag
                @text="{{this._getFilterKeyText key filter}} {{this._getGenericFilterValueText filter}}"
                @onDismiss={{fn this._onFilterDismiss key}}
              />
            {{else if (eq filter.type "multi-select")}}
              {{#each (this._getMultiSelectFilterData filter.data) as |item|}}
                <Hds::Tag
                  @text="{{this._getFilterKeyText key filter}}: {{if item.label item.label item.value}}"
                  @onDismiss={{fn this._onFilterDismiss key item.value}}
                />
              {{/each}}
            {{/if}}
          {{/if}}
        {{/each-in}}
        <Hds::Button
          class="hds-filter-bar__clear-button"
          @text="Clear all filters"
          @color="tertiary"
          @icon="x"
          @size="small"
          {{on "click" this.clearFilters}}
        />
      {{else}}
        <Hds::Text::Body @size={{100}} @color="faint">
          {{hds-t "hds.components.filter-bar.no-filters-applied" default="No filters applied"}}
        </Hds::Text::Body>
      {{/if}}
    </div>
  {{/if}}
</div>