{{!
  Copyright (c) HashiCorp, Inc.
  SPDX-License-Identifier: MPL-2.0
}}
{{yield
  (hash
    data=@record
    depth=this.depth
    id=this._id
    isExpandable=@record.hasChildren
    isOpen=@record.openState
    parentId=@parentId
    rowIndex=this.rowIndex
    shouldDisplayChildRows=@shouldDisplayChildRows
    onClickToggle=@record.toggleIsOpen
  )
}}
{{#if @record.hasChildren}}
  {{#each @record.children as |childRecord|}}
    <Hds::AdvancedTable::ExpandableTrGroup
      @align={{@align}}
      @depth={{this.childrenDepth}}
      @record={{childRecord}}
      @parentId={{this._id}}
      @rowIndex="{{this.rowIndex}}.{{this.childrenDepth}}"
      @shouldDisplayChildRows={{@record.showChildren}}
      as |T|
    >
      {{yield
        (hash
          data=T.data
          depth=T.depth
          id=T.id
          isExpandable=T.isExpandable
          isOpen=T.isOpen
          parentId=T.parentId
          shouldDisplayChildRows=T.shouldDisplayChildRows
          onClickToggle=childRecord.toggleIsOpen
        )
      }}
    </Hds::AdvancedTable::ExpandableTrGroup>
  {{/each}}
{{/if}}